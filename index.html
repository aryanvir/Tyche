<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title>Tyche</title>

    <script src="https://code.jquery.com/jquery-3.6.0.js" integrity="sha256-H+K7U5CnXl1h5ywQfKtSj8PCmoN9aaq30gDh27Xc0jk=" crossorigin="anonymous"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
   <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
    <script async src="https://api.countapi.xyz/hit/tyche/f607b6de-24ab-4b3e-af25-e60d4bc0ebee?callback=websiteVisits"></script> 
    <script>

    </script>
   <!-- Custom styles -->
    <link rel="stylesheet" href="style.css">
    <!-- "namespace": "tyche",
    "key": "f731c21f-f4a8-47bf-b0db-8ee98ae4a367",
    "value": 0 -->
  </head>
  <body>
    
    <div class="counter" id="myform">
      <span id="visits">1</span>
      <p>With more than <span id="visit-state"></span> uses, you can trust us to help you.</p>
    </div>
    <div class="form-section">
        <div class="tablink-div">
            <button class="tablink" onclick="openPage('manual-form', this, '#f0f5f9')" id="defaultOpen">Form</button>
            <button class="tablink" onclick="openPage('file-upload', this, '#f0f5f9')" >Download Resume</button>
        </div>
    

    <div class="form">
        
        <div id="manual-form" class="tabcontent">
            <form id="manualForm">

                <h1 class="h3 mb-3 fw-normal fade-in">Resume Information</h1>
                <p>Enter your details</p>
                <div class="input-form">
                <input type="text" name="name" class="top form-control " id="name" placeholder="Name" required >
                <input type="text" name="descrip" class="form-control middle" id="descrip" placeholder="Description" style="height:10vh;" required>
                <input type="email" name="mailID" class="form-control middle" id="mailID" placeholder="Email" required>
                <input type="text" name="skills" class="form-control middle" id="skills" placeholder="Skills(comma separated)" required>
                <input type="text" name="skills" class="form-control middle" id="skills" placeholder="Skills(comma separated)" required>
                <input type="text" name="edLocation" class="form-control middle " id="edLocation" placeholder="Education Location" required>
                <input type="text" name="edTitle" class="form-control middle " id="edTitle" placeholder="Educational Degree/Title" required>
                <input type="text" name="edDescrip" class="form-control middle " id="edDescrip" placeholder="Education Description" style="height:10vh;" required>
                <input type="text" name="edDuration" class="form-control middle " id="edDuration" placeholder="Education Duration(ex:2020-2023)" required>
                <input type="text" name="proLocation" class="form-control middle " id="proLocation" placeholder="Work Location" required>
                <input type="text" name="proTitle" class="form-control middle " id="proTitle" placeholder="Professional Position/Title" required>
                <input type="text" name="proDescrip" class="form-control middle " id="proDescrip" placeholder="Profession Description" style="height:10vh;" required>
                <input type="text" name="proDuration" class="form-control middle " id="proDuration" placeholder="Work Duration(years)" required>
              </div>  
                <button class="btn btn-lg btn-primary mybt" type="submit" onclick="">Submit</button>
                <p class="mt-5 mb-3"></p>
              </form>
        </div>
        <div id="file-upload" class="tabcontent">
            
              
              <iframe src="port.html" frameborder="0" id="frame" class="frame" style="width:100%;height:70vh;border-radius:5px;"></iframe>
              <button class="btn btn-lg btn-primary mybt" onclick="handleDownload()">Download</button>
            
        </div>
        
      </div>
    </div>
    

 
   

    <script type="text/javascript">
    function handleDownload(){
        sessionStorage.redirected=true;
        window.location.href='../tyche2.0/port.html';
    }
    var i, tabcontent, tablinks;
    tabcontent = document.getElementsByClassName("tabcontent");
    tablink= document.getElementsByClassName("tablink");
    function openPage(pageName, elmnt, color){
        for (i=0;i<tabcontent.length;i++){
            tabcontent[i].style.display="none";
            tablink[i].style.backgroundColor="";
        }
        document.getElementById(pageName).style.display="block";
        elmnt.style.backgroundColor="#f0f5f9";
        if (pageName=="manual-form"){
            document.getElementsByClassName("form")[0].style.maxWidth="70%";
        }else if (pageName=="file-upload") {
            document.getElementsByClassName("form")[0].style.maxWidth="90%";
        }

    }
    document.getElementById("defaultOpen").click();
    // function fileUpload(){
    //   var label=document.getElementById("labelFile");
    //   var pathArr=document.getElementById("file").value.split("\\");
    //   label.innerHTML=pathArr[pathArr.length-1].length>0? pathArr[pathArr.length-1].length>12 ? pathArr[pathArr.length-1].slice(0,12)+"...":pathArr[pathArr.length-1] : "Choose File";
    // }
    function makeDatetime(year){
        var d= new Date(year, 0);

        return d;
      }
    function handleForm(event){
      event.preventDefault();
      const Data= new FormData(event.target);
      const value = Object.fromEntries(Data.entries());
      const jsonString= JSON.stringify(value);
      
      const newJsonString= JSON.stringify({
        name:value.name,
        description:value.descrip,
        email:value.mailID,
        skills:value.skills.split(","),
        education:{
          location:value.edLocation,
          title:value.edTitle,
          description:value.edDescrip,
          timeDuration:(value.edDuration.split("-"))//.map(makeDatetime)
        },
        work:{
          location:value.proLocation,
          title:value.proTitle,
          description:value.proDescrip,
          timeDuration:(value.proDuration.split("-"))//.map(makeDatetime)
        }
      });
      sessionStorage.formData = newJsonString;

      let elmnt=document.getElementsByClassName("tablink")[1];
      openPage("file-upload", elmnt);
      document.getElementById("frame").src= document.getElementById("frame").src;
    }
    const form = document.getElementById('manualForm');
    form.addEventListener('submit', handleForm);
    $(document).ready(function() {

    });
      const sleep = (milliseconds) => {
        return new Promise(resolve => setTimeout(resolve, milliseconds))
      }
      async function websiteVisits(res){
        document.getElementById("visit-state").textContent=res.value;
        var start= res.value > 40? res.value-25:0
        for (i=start;i<=res.value;i++){
          await sleep(30);
          document.getElementById("visits").textContent=i;
        }
       
      }
     
    </script>
  </body>
</html>